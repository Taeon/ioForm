!function(a,b){"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?module.exports=b():a.ioForm=b()}(this,function(){"use strict";var a=function(a){if("string"==typeof a){var b=document.querySelectorAll(a);if(0===b.length)throw new Error('ioForm error: Selector ["'+a+'"] returns no elements');b.length>1&&(console.log('ioForm warning: Selector ["'+a+'"] returns more than one element. All but the first element will be ignored. Selected elements are:'),console.log(b)),a=b[0]}else if("object"==typeof a&&!(a instanceof HTMLElement)&&"undefined"!=typeof a.length){if(0===a.length)throw new Error("ioForm error: Collection contains no elements");a.length>1&&(console.log("ioForm warning: Collection contains more than one element. All but the first element will be ignored. Selected elements are:"),console.log(a)),a=a[0]}if(!a.tagName||"form"!=a.tagName.toLowerCase())throw new Error("ioForm error: Element is not a form");var c;if(a.ioForm)return a.ioForm;this.ready=!1,Events.Register(this,a),a.ioForm=this,this.fields={};for(var d=a.querySelectorAll("input,select,textarea"),e={},f=0;f<d.length;f++){var g=d[f];if(g.hasAttribute("name")){switch(c=g.getAttribute("name"),g.tagName.toLowerCase()){case"input":var h=g.getAttribute("type").toLowerCase();if("radio"==h){g.hasAttribute("name")&&(c=g.getAttribute("name"),"undefined"==typeof e[c]&&(e[c]=[]),e[c].push(g));continue}var i="Default";"undefined"!=typeof this.input_field_types[h]&&(i=this.input_field_types[g.getAttribute("type")]),this.fields[c]=new window["ioFormField"+i](g);break;case"select":this.fields[c]=new ioFormFieldSelect(g);break;case"textarea":this.fields[c]=new ioFormFieldDefault(g)}this.fields[c].on("ioform:ready",this.onFieldReady.bind(this))}}for(c in e)e.hasOwnProperty(c)&&(this.fields[c]=new ioFormFieldRadio(e[c]),this.fields[c].on("ioform:ready",this.onFieldReady.bind(this)));for(c in this.fields)this.fields.hasOwnProperty(c)&&this.fields[c].onFormReady()};return a.prototype={input_field_types:{checkbox:"Checkbox",date:"Date",number:"Number"},onFieldReady:function(){for(var a in this.fields)if(this.fields.hasOwnProperty(a)&&!this.fields[a].ready)return;this.ready=!0,this.onReady()},onReady:function(){this.ready&&this.trigger("ioform:ready",{form:this})},HasField:function(a){return"undefined"!=typeof this.fields[a]},GetField:function(a){return this.HasField(a)?this.fields[a]:null},GetValue:function(a){return this.HasField(a)?this.fields[a].GetValue():null},SetValue:function(a,b){this.HasField(a)&&this.fields[a].SetValue(b)}},a});var ioFormField=function(a){this.ready=!1,this.element=a,Events.Register(this,a),this.ready=!0};ioFormField.prototype={onFormReady:function(){this.ready&&this.trigger("ioform:ready",{field:this})},GetValue:function(){return this.element.value},SetValue:function(a){this.element.value=a,this.trigger("change")},Disable:function(){this.element.setAttribute("disabled","")},Enable:function(){this.element.removeAttribute("disabled")}};var ioFormFieldCheckbox=function(a){ioFormField.call(this,a)};extend(ioFormFieldCheckbox,ioFormField),ioFormFieldCheckbox.prototype.SetValue=function(a){this.element.checked=a,this.trigger("change")},ioFormFieldCheckbox.prototype.GetValue=function(){return this.element.checked},ioFormUtility={ZeroPad:function(a,b){var c=Math.abs(a),d=Math.max(0,b-Math.floor(c).toString().length),e=Math.pow(10,d).toString().substr(1);return a<0&&(e="-"+e),e+c}};var ioFormFieldDate=function(a){ioFormField.call(this,a)};extend(ioFormFieldDate,ioFormField),ioFormFieldDate.prototype.SetValue=function(a){"string"==typeof a&&(a=new Date(Date.parse(a))),"Invalid Date"!=a.toString()?this.element.value=a.getFullYear()+"-"+ioFormUtility.ZeroPad(a.getMonth()+1,2)+"-"+ioFormUtility.ZeroPad(a.getDate(),2):this.element.value="",this.trigger("change")},ioFormFieldDate.prototype.GetValue=function(){var a=new Date(Date.parse(this.element.value));return"Invalid Date"!=a.toString()?a:null};var ioFormFieldNumber=function(a){ioFormField.call(this,a)};extend(ioFormFieldNumber,ioFormField),ioFormFieldNumber.prototype.GetValue=function(){return+this.element.value};var ioFormFieldRadio=function(a){ioFormField.call(this,a)};extend(ioFormFieldRadio,ioFormField),ioFormFieldRadio.prototype.SetValue=function(a){a=a.toString();for(var b=0;b<this.element.length;b++)if(this.element[b].value==a){this.element[b].checked=!0;break}this.trigger("change")},ioFormFieldRadio.prototype.GetValue=function(){for(var a=0;a<this.element.length;a++)if(this.element[a].checked)return this.element[a].value;return null},ioFormFieldRadio.prototype.Disable=function(){for(var a=0;a<this.element.length;a++)this.element[a].setAttribute("disabled","disabled")},ioFormFieldRadio.prototype.Enable=function(){for(var a=0;a<this.element.length;a++)this.element[a].removeAttribute("disabled")};var ioFormFieldSelect=function(a){ioFormField.call(this,a)};extend(ioFormFieldSelect,ioFormField),ioFormFieldSelect.prototype.GetValue=function(){var a=this.element.querySelectorAll("option:checked");if("undefined"!=typeof this.element.getAttribute("multiple"))for(var b=[],c=0;c<a.length;c++)a[c].hasAttribute("value")&&b.push(a[c].getAttribute("value"));else{var b="";if(a.length>0){var d=a.pop();if(d.hasAttribute("value"))var b=d.getAttribute("value")}}return b},ioFormFieldSelect.prototype.SetValue=function(a){if("undefined"!=typeof this.element.getAttribute("multiple")&&null!=this.element.getAttribute("multiple")){this.ClearOptions(),"[object Array]"!==Object.prototype.toString.call(a)&&(a=[a]);for(var b=0;b<a.length;b++)for(var c=this.element.querySelectorAll('option[value="'+a[b].toString()+'"]'),d=0;d<c.length;d++)c[d].selected=!0}else for(var c=this.element.querySelectorAll('option[value="'+a.toString()+'"]'),d=0;d<c.length;d++)c[d].selected=!0;this.trigger("change")},ioFormFieldSelect.prototype.ClearOptions=function(){for(var a=this.element.querySelectorAll("option"),b=0;b<a.length;b++)a[b].selected=!1};var ioFormFieldDefault=function(a){ioFormField.call(this,a)};extend(ioFormFieldDefault,ioFormField);